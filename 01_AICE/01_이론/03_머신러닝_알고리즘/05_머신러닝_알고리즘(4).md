# AI 성능평가 지표(1)

- 회귀 모델 관련 성능 평가 지표
  - MSE(Mean Squared Error): $(실제값 - 예측값)^2$의 평균
  - MAE(MEan Absolute Error): $|실제값 - 예측값|$의 평균
  - R2(결정계수): 독립변수가 종속변수를 얼마나 잘 설명하는지
  - MSE, MAE는 동일한 알고리즘을 사용할 때 사용

- 분류 모델 관련 성능 평가 지표
  - Accuracy(정확도) = 각 라벨별 정답 개수 / 전체 라벨 개수
  - Recall(재현율) = 내가 맞힌 1의 개수 / 전체 데이터 중 1의 개수
  - Precision(정밀도) = 내가 맞힌 1의 개수 / 내가 1이라 예측한 개수

- 정밀도와 재현율은 생소하고, 이해하기 어려운 개념임. 사례로 한 번 더 짚고 가자.
  - 양성 정밀도 = $TP / (TP + FP(양성으로 잘못 예측))$
  - 양성 재현율 = $TP / (TP + FN(음성으로 잘못 예측))$
  - 암 진단 예측 모델이라 가정:
    - 암인데 암이 아니라고 진단하는 경우, 암이 아닌데 암이라고 진단하는 경우, 어떤 게 더 치명적일까?
    - 암인데 암이 아니라고 예측한 경우가 더 치명적이므로,
    - 음성으로 잘못 예측(FN)을 더 낮추기 위해 노력 필요
    - 양성 재현율을 높이기 위해 학습 방향 설정
  - 스팸 메일 예측 모델이라 가정:
    - 스팸인데 정상이라 판단하는 경우, 정상인데 스팸이라 판단하는 경우, 어떤 게 더 치명적인가?
    - 정상인데 스팸으로 판단하고 차단하는 경우가 더 치명적이므로,
    - 양성으로 잘못 예측(FP)을 더 낮추기 위해 노력 필요
    - 양성 정밀도를 높이기 위해 학습 방향 설정
  - 정확도로 성능을 평가하면 가장 편리하지만, 세부적으로 반드시 피해야 하는 Case가 있는 경우에는 정밀도와 재현율 중 상황에 적합한 성능 평가 지표를 이용해 모델을 평가하는 것이 적절한 평가라 할 수 있다.

# 머신러닝 실습

- 실습에 사용할 알고리즘
  - 회귀 모델 실습: KNN, Decision Tree, Random Forest, **Linear Regression**
  - 분류 모델 실습: KNN, Decision Tree, Random Forest, **Logistic Regression**

- 회귀 모델 실습
  - 지하철 이용객 수 예측
    1. 데이터 분석
       - 데이터 샘플 보기로 데이터의 생김새 우선 파악
       - 기초 정보 분석
    2. AI모델 학습 선택
       - 머신러닝, 딥러닝 중 머신러닝 선택
    3. 학습 유형 선택
       - 회귀, 분류 중 회귀 선택
    4. 타겟 변수 선택
       - Input 컬럼의 traffic_volume을 Output 컬럼으로 이동
    5. 독립 변수 수정
       - "Data Parameter 설정"에서
       - Input 컬럼의 hour: Numeric -> Categorical로 변경
       - Input 컬럼의 dayofweek: Numeric -> Categorical로 변경
    6. 머신러닝 모델 선택
       - 회귀에 사용할 4개 모델 선택 (선형 회귀, KNN, 의사결정 나무, 랜덤 포레스트)
       - (학습 시간을 줄이기 위해 교차 검증 fold 수는 10에서 2로 변경)
    7. 학습 시작
    8. 학습 결과
       - MAE, MSE는 동일한 알고리즘일 때 사용하므로 제외
       - R2에서 선형 회귀 모델은 마이너스이므로 사용할 수 없음을 보여줌
       - 나머지 R2 중 가장 높은 값이 좋은 모델이라 할 수 있다.

- 분류 모델 실습
  - 호텔 예약 취소 여부 예측
    1. 데이터 분석
       - 데이터 샘플 보기로 데이터의 생김새 우선 파악
       - 기초 정보 분석
    2. AI모델 학습 선택
       - 머신러닝, 딥러닝 중 머신러닝 선택
    3. 학습 유형 선택
       - 회귀, 분류 중 분류 선택
    4. 타겟 변수 선택
       - Input 컬럼의 is_canceled를 Output 컬럼으로 이동
    5. 독립 변수 수정
       - "Data Parameter"에서 설정
       - Input 칼럼의
         - arrival_date_year: Numeric -> Categorical로 변경
         - arrival_date_week_number: Numeric -> Categorical로 변경
         - arrival_date_day_of_month: Numeric -> Categorical로 변경
         - is_repeated_guest: Numeric -> Categorical로 변경
    6. 머신러닝 모델 선택
       - 회귀에 사용할 4개 모델 선택 (로지스틱 회귀, KNN, 의사결정 나무, 랜덤 포레스트)
       - (학습 시간을 줄이기 위해 교차 검증 fold 수는 10에서 2로 변경)
    7. 학습 시작
    8. 학습 결과
       - Accuracy, Recall, Precision 중 적합한 값을 선택해서 성능 개선에 사용
