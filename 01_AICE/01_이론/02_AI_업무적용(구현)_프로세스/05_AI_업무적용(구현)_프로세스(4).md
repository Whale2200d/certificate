# AI 모델링

- AI 모델링은 알고리즘을 선택하고, 준비된 데이터로 모델을 학습시키고, 모델 평가하고 개선한다. (알고리즘 선택 -> 준비된 데이터로 모델 학습 -> 모델 평가 및 개선)

## AI 알고리즘 선택

지도학습

- 타겟변수의 형태에 따라 알고리즘 선택
- 타겟이 Class(카테고리)가 나눠진 경우, 분류 학습
- 타겟이 수치형 데이터인 경우, 회귀 학습

과제의 목적

- 과제의 목적에 맞는 알고리즘 선택
- 예측
  - 결과 자체가 중요
  - 미래 상황에 대비한 정확성 중요
- 설명
  - 결과에 대한 원인 분석이 중요
  - 결과에 영향을 주는 요소가 중요

- 예시
  - 과일 가게 장사 시작
  - 예측
    1. 다음 월의 매출 예측
    2. 매출 예측에 따른 원재료 구매
    - 예측이 필요하다면 딥러닝, 머신러닝, 앙상블 모델
  - 설명
    1. 전월 매출 하락 원인 및 변수 분석
    2. 새로운 마켓팅 전략 수립
    - 설명이 필요하다면 딥러닝보다 머신러닝

## 용어

손실함수(Loss Function)

- 모델의 예측값과 실제값 차이를 계산하는 것
- 손실함수가 작을수록 잘 예측한 것
- 손실함수 최소화를 위해 **모델의 가중치를 업데이트 반복**

가중치(Weight)

- 실제값을 예측하기 위한 예측 함수의 계수
- 오차를 최소화하기 위해 모델이 가중치를 조금씩 조정한다.

## 데이터 분리

- 학습/검증/평가 데이터로 분리
- 검증: 학습 결과 중간 검증 및 하이퍼파라미터 튜닝 검증용 데이터
  - 하이퍼파라미터: 조정할 수 있는 파라미터를 의미함
- 데이터를 분리하는 이유
  - 학습 정도에 따라 범용적 데이터 예측이 불가한 **과적합(Over Fitting)** 발생할 수 있음.
  - 과적합 상태는 훈련 데이터만 성능이 좋고, 검증/평가 데이터는 성능이 좋지 않다. 즉, 범용 데이터에서 예측이 불가하다.

과적합(Overfitting)

- 학습 데이터에 대표성이 없거나, 너무 많이 학습한 경우
- 예시
  - 학교별 학업성취도 평가를 위한 학생 선발
  - 성적별 고르게 학생을 선발하면, 학교 성적을 대표할 수 있음.
  - 최상위권 학생만 선발하면, 학교 성적을 대표할 수 없음.
- 해결방법
  - Early Stop: 과적합 발생 시 학습 조기 종료
    - Epoch, Loss 관계 그래프로 확인
  - Dropout: 딥러닝 알고리즘에서 임의로 연결 제거
    - 노드는 기본적으로 Fully Connected 상태이므로 이 중 일부 연결을 제거

학습파라미터

- 1 Epoch: 모든 데이터 셋을 한 번 학습
- Minibatch: 데이터 셋을 batch size 크기로 쪼개서 학습
- 1 iteration: mini batch 데이터 셋의 1회 학습, 전체를 배치사이즈로 나눈 값

# AI 적용

## 모델 평가

- 평가 지표
  - AI 과제 유형별 성능평가 지표
    - Regression Model, Classification Model
    - RM
      - MSE(Mean Squared Error), MAE(Mean Absolute Error): 실제값과 예측값 간 차이, 작을수록 좋은 성능
      - R2(Coefficient of Determination): 회귀모델의 설명력, 클수록 좋은 성능
    - CM
      - Accuracy(정확도) = 각 Label별 정답 개수 / 전체 Label 개수
      - Recall(재현율) = 내가 맞힌 1의 개수 / 전체 데이터 중 1의 개수
      - Precision(정밀도) = 내가 맞힌 1의 개수 / 내가 1이라 예측한 개수
      - F1-Score = 2 * (Pre*Recall) / (Pre+Recall)

  - Confusion Matrix(혼란 메트릭스)
    - 맞춘 결과 + 예측
      - TP(True Positive)
      - FP(False Positive)
      - FN(False Nagative)
      - TN(True Negative)
    - Recall = TP / (TP + FN)
    - Precision = TP / (TP + FP)

- 평가 기준
  - 비교 대상을 찾아서 평가 기준 수립
    - 유사과제 성능
    - 기존방식 성능

## 모델 성능 개선

데이터 추가 및 생성 방법

- 학습데이터 추가: 학습데이터를 늘려 학습(빅데이터 등 활용)
- 파생변수 생성: 피쳐 엔지니어링을 통해 데이터 분석(새로운 변수 생성)

모델 튜닝 방법

- 알고리즘 변경: 더 좋은 성능의 알고리즘으로 변경(여러 알고리즘 성능 비교)
- 파라미터 변경: 딥러닝/머신러닝의 하이퍼파라미터(직접 설정 가능 파라미터)

## 적용

- 개발한 모델은 상용화할텐데, 이때 중요한 것은 충분히 테스트하는 게 중요
- 지속적인 활용이 가능하도록 시스템화 하고 유지보수하는 영역이 필요
  - 신규 데이터를 지속적으로 수집해야 한다.
  - 모델을 지속적으로 업데이트해야 한다.
