# 데이터 전처리

- 전처리는 데이터가 학습이 가능한 상태의 데이터로 만드는 과정이다.
- 4가지 방법: 결측치 처리, 이상치 처리, 인코딩, 스케일링

## 결측치 처리

- 데이터 분석/모델링이 가능하도록 비어있는 값을 처리
- **제거**하는 방법(Drop): Row / Col 단위
- 결론: 정보의 손실이 발생하면, 비즈니스 관점 영향도 고려해야 함.

- **대체**하는 방법(Fill): (수치형)평균/중앙값, (카테고리형)최빈값, 유사 벡터값
- 결론: 데이터가 충분치 않은 경우, 데이터를 채워 학습 수행
- 주의: 데이터 관점의 접근일 뿐, 해당 도메인의 전문가가 결정하는 방법이 가장 좋다.
  - 예시: 반도체 생산 데이터라면, 반도체 생산 관련 전문 지식인이 더 정확하게 채울 수 있을 것이다.

## 이상치 처리

- 추세/패턴에 벗어나는 이상치를 탐지하고 처리
- **IQR Smoothing** 방법:
  - IQR = Q3 - Q1
  - Upper Fence = Q3 + IQR \* 1.5
  - Lower Fence = Q1 - IQR \* 1.5
- 박스차트를 활용하면 이상치를 시각적으로 확인 가능
  - Fence 값은 IQR 1.5배보다 크거나 작게 설정 가능
  - IQR 기법 외에 다른 기준도 적용 가능
    - 예시: 표준화(Z-Score) 후 표준편차기준으로 탐지
    - 예시: 결정트리 등 머신러닝 알고리즘 활용

의미있는 이상치

- 의미있는 이상치는 처리하지 않음.
- 의미있는 이상치:
  - 오류, 불량 등 이상치를 찾는 모델의 경우
  - 데이터 기준 판단: 한쪽 클래스에만 이상치가 있다면
- 처리가 필요한 이상치
  - 오류, 불량 등을 찾는 모델이 아닌 경우
  - 데이터 기준 판단: 양쪽 클래으세 이상치 비율이 유사하다면

## 인코딩

- 카테고리형 데이터(A~D)를 컴퓨터가 이해 가능한 더미데이터(0과 1)로 가공하는 과정
- AI가 학습할 수 있는 형태로 가공
- 예시:
  - Origin 데이터(A~C)를 사용할 수 없으므로, 이해 가능한 형태로 변경
  1. **Ordinal** Encoding
     - 0, 1, 2로 변경
     - 한계: 1이 2의 절반이라고 볼 수 없음. (차원의 저주)
  2. **One-Hot** Encoding
     - 각 카테고리별 더미 칼럼 생성(A, B, C)
     - 각 Row별 해당하는 칼럼에 0, 1로 데이터 생성
     - 장점: 데이터 간 거리가 동일

Ordinal Encoding

- 데이터 value 값에 순서가 있는 경우
- 예시:
  - Origin: A, B, C, D, F
  - Original Encoding: 5, 4, 3, 2, 1

One-Hot Encoding

- 데이터 value 값에 순서가 없는 경우
- 예시:
  - Origin: 인문, 사회, 자연, 공학
  - One-Hot Encoding:
    - (1, 0, 0, 0)
    - (0, 1, 0, 0)
    - (0, 0, 1, 0)
    - (0, 0, 0, 1)

## 스케일링

- 앞선 과정을 마치면 모두 수치형 데이터가 되어 있을 것이다.
- 스케일링은 수치형 데이터에 대해 수치 단위를 맞추고자 수치 크기를 변경하는 작업
- 수치의 범위가 크다면, 더 중요한 데이터로 판단할 수 있다. 따라서 데이터 스케일링을 통해 표준화/정규화가 필요하다.

스케일링 방식

- **Min-Max** Scaling
  - normalization
  - (data - Min) / (Max - Min)
  - 모든 데이터를 0~1 사이로 맞추는 방법
  - 주로 사용하는 스케일링 기법
- **Standard** Scaling
  - standardization
  - (data - Mean) / std(표준편차, standard deviation)
  - 평균을 0, 표준편차를 1로 맞추는 방법
  - 데이터의 이상치가 심할 경우 사용
